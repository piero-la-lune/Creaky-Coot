function isset(e){return e!==void 0&&null!==e}function Ajax(e,t){this.post=[],this.elm=void 0,this.loader=void 0,e&&(this.elm=e,this.loader=document.createElement("span"),this.loader.className="loading",this.loader.innerHTML='<i class="n1"></i><i class="n2"></i><i class="n3"></i>',this.elm.parentNode.replaceChild(this.loader,this.elm)),this.post.push("action="+t),this.post.push("page="+page),this.addParam=function(e,t){this.post.push(e+"="+encodeURIComponent(t))},this.send=function(e,t){var n=this,i=new XMLHttpRequest;i.open("POST",ajax_url),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(this.post.join("&")),i.onreadystatechange=function(){if(i.readyState==i.DONE){if(200==i.status){var a=JSON.parse(i.responseText);"success"==a.status?e!==void 0&&e(a):t!==void 0&&t(a)}else 403==i.status?alert(m_error_login):alert(m_error_ajax);n.cancel()}}},this.cancel=function(){this.loader&&this.loader.parentNode.replaceChild(this.elm,this.loader)}}function onclick_logout(){document.getElementById("form-logout").submit()}function onclick_load(e,t){var n=new Ajax(e,"load"),i=document.querySelectorAll(".div-link");i.length>0&&n.addParam("id",i[i.length-1].id.split("-")[1]),"undefined"!=typeof feed&&n.addParam("feed",feed),"undefined"!=typeof tag&&n.addParam("tag",tag),"undefined"!=typeof q&&n.addParam("q",q),t.type!==void 0&&n.addParam("type",t.type),n.send(function(e){var t=document.createElement("div");t.innerHTML=e.html;var n=document.querySelector(".p-more");n.parentNode.insertBefore(t,n)},function(){n.elm=document.createElement("span"),n.elm.innerHTML=m_no_more_link})}function onclick_refresh(e){var t=new Ajax(e,"refresh");return"undefined"!=typeof tag?(t.cancel(),!1):"undefined"!=typeof q?(t.cancel(),!1):("undefined"!=typeof feed&&t.addParam("feed",feed),t.send(function(e){var t=document.createElement("div");t.innerHTML=e.html;var n=document.querySelector(".div-link");n||(n=document.querySelector(".p-more")),n.parentNode.insertBefore(t,n)}),void 0)}function onclick_allRead(e){for(var t=new Ajax(e,"read"),n=[],i=document.querySelectorAll(".div-link"),a=0;i.length>a;a++)n.push(i[a].id.split("-")[1]);t.addParam("ids",n.join(",")),t.send(function(e){for(var t in e.ids){var n=document.getElementById("link-"+t);if("links"==page)n.querySelector("h2").className="",n.querySelector(".a-read").style.display="none",n.querySelector(".a-unread").style.display="inline-block";else{var i=n.parentNode;i.removeChild(n)}}})}function onclick_allClear(e){if(!confirm(m_confirm_clear))return!1;for(var t=new Ajax(e,"clear"),n=[],i=document.querySelectorAll(".div-link"),a=0;i.length>a;a++)n.push(i[a].id.split("-")[1]);t.addParam("ids",n.join(",")),t.send(function(e){for(var t in e.ids){var n=document.getElementById("link-"+t);n.parentNode.removeChild(n)}})}function onclick_read(e,t){var n=new Ajax(e,"read");n.addParam("ids",t.id),n.send(function(n){if(n.ids[t.id]===void 0)return!1;var i=document.getElementById("link-"+t.id);"home"==page?i.parentNode.removeChild(i):("links"==page&&(i.querySelector("h2").className=""),e.style.display="none",i.querySelector(".a-unread").style.display="inline-block")})}function onclick_unread(e,t){var n=new Ajax(e,"unread");n.addParam("ids",t.id),n.send(function(n){if(n.ids[t.id]===void 0)return!1;var i=document.getElementById("link-"+t.id);"links"==page&&(i.querySelector("h2").className="unread"),e.style.display="none",i.querySelector(".a-read").style.display="inline-block"})}function onclick_archive(e,t){var n=new Ajax(e,"archive");n.addParam("ids",t.id),n.send(function(n){if(n.ids[t.id]===void 0)return!1;var i=document.getElementById("link-"+t.id);"home"==page?i.parentNode.removeChild(i):("links"==page&&(i.querySelector("h2").className=""),i.querySelector(".a-read").style.display="none",i.querySelector(".a-unread").style.display="none",e.style.display="none")})}function onclick_delete(e,t){if(!confirm(m_confirm_delete))return!1;var n=new Ajax(e,"delete");n.addParam("ids",t.id),n.send(function(e){if(e.ids[t.id]===void 0)return!1;if("link"==page)window.location.href=home_url;else{var n=document.getElementById("link-"+t.id);n.parentNode.removeChild(n)}})}function onclick_edit(e,t){var n={title:document.querySelector("h1"),content:document.querySelector(".div-content"),tags:document.querySelector(".tags"),comment:document.querySelector(".div-comment"),url:document.querySelector(".p-url"),actions:document.querySelectorAll(".div-actions")},i={tags:document.getElementById("tags"),editTags:document.querySelector(".editTags"),editor:document.querySelector(".div-edit")},a=n.title.innerHTML,o=n.content.innerHTML,d=n.comment.innerHTML,l=i.tags.value,r=n.actions[1].querySelectorAll("a")[0],c=n.actions[1].querySelectorAll("a")[1];n.title.setAttribute("contenteditable",!0),n.content.setAttribute("contenteditable",!0),n.comment.setAttribute("contenteditable",!0),n.tags.style.display="none",n.url.style.display="none",i.editTags.style.display="inline",i.editTags.querySelector("span").innerHTML="",i.tags.onupdate(),i.editor.style.display="block",n.actions[0].style.display="none",n.actions[1].style.display="block",r.onclick=function(){var e=new Ajax(r,"edit");e.addParam("id",t.id),e.addParam("title",n.title.innerHTML),e.addParam("content",n.content.innerHTML),e.addParam("tags",i.tags.value),e.addParam("comment",n.comment.innerHTML),e.send(function(e){a=e.title,o=e.content,d=e.comment,l=e.tags.join(", "),c.click(),n.tags.innerHTML=e.tags_list})},c.onclick=function(){n.title.setAttribute("contenteditable",!1),n.content.setAttribute("contenteditable",!1),n.comment.setAttribute("contenteditable",!1),n.title.innerHTML=a,n.content.innerHTML=o,n.comment.innerHTML=d,n.tags.style.display="inline",n.url.style.display="block",i.editTags.style.display="none",i.tags.value=l,i.editor.style.display="none",n.actions[0].style.display="block",n.actions[1].style.display="none"}}function onload_tags(){function e(){for(var e=o.querySelectorAll(".tag"),t=[],n=0;e.length>n;n++)t.push(e[n].innerHTML);l.value=t.join(",")}function t(t){return t.target.parentNode.removeChild(t.target),e(),!1}function n(e){var n=document.createElement("a");n.href="#",n.className="tag",n.innerHTML=e,d.appendChild(n),n.onclick=t}function i(){""!==r.value&&(n(r.value),r.value="",e())}function a(){if(""!==l.value)for(var e=l.value.split(/,/),t=0;e.length>t;t++)n(e[t])}var o=document.querySelector(".editTags"),d=o.querySelector("span"),l=document.getElementById("tags"),r=document.getElementById("addTag"),c=document.querySelector(".pick-tag"),s=c.querySelectorAll("span"),u=!1;c.onmousedown=function(e){"visible"==e.target.className&&(r.value=e.target.innerHTML,i(),u=!0)},r.onkeydown=function(e){if("keyCode"in e&&(13==e.keyCode||188==e.keyCode)||"key"in e&&("Enter"==e.key||","==e.key))return i(),r.blur(),r.focus(),!1;if("keyCode"in e&&9==e.keyCode||"key"in e&&"Tab"==e.key){var t=form.list.querySelector(".visible");return null!==t&&(r.value=t.innerHTML,i(),r.blur(),r.focus()),!1}},r.onfocus=function(){var e=r.getBoundingClientRect();c.style.left=e.left+"px",c.style.top=e.bottom+"px",r.onkeyup()},r.onblur=function(){u?(u=!1,setTimeout("document.getElementById('addTag').focus()",10)):(c.style.left="-9999px",c.style.top="-9999px")},r.onkeyup=function(){for(var e=r.value,t=0;s.length>t;t++)s[t].className=-1===s[t].innerHTML.indexOf(e)?"":"visible"},l.onupdate=a,a()}function onclick_clear_feed(e,t){if(!confirm(m_confirm_clear_f))return!1;var n=new Ajax(e,"clear_feed");n.addParam("feed",t.id),n.send()}function onclick_delete_feed(e,t){if(!confirm(m_confirm_delete_f))return!1;var n=new Ajax(e,"delete_feed");n.addParam("feed",t.id),n.send(function(){var e=document.getElementById("feed-"+t.id);e.parentNode.removeChild(e)})}function onclick_js_add(){alert(m_add_popup),document.getElementById("js_add").style.display="block"}function onclick_formate(e,t){if("link"==t.cmd){var n=prompt(m_enter_url,"http://");if(n&&"http://"!=n)return document.execCommand("createlink",!1,n)}if("image"!=t.cmd)return t.value!==void 0?document.execCommand(t.cmd,!1,t.value):document.execCommand(t.cmd,!1,null);var i=prompt(m_enter_url,"http://");return i&&"http://"!=i?document.execCommand("insertImage",!1,i):!1}null!==document.querySelector(".editTags")&&onload_tags();